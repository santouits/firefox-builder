# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- script: |
    export SHELL=/bin/bash
    export MOZCONFIG="$(pwd)/mozconfig"
    echo $MOZCONFIG
    wget -q https://ftp.mozilla.org/pub/firefox/releases/69.0.1/source/firefox-69.0.1.source.tar.xz
    tar -xf firefox*
    rm *.xz
    mv firefox* source
    ls
    cd source
    sudo sed -Ei 's/^# deb-src /deb-src /' /etc/apt/sources.list
    sudo apt-get update
    sudo apt-get upgrade
    sudo apt-get build-dep firefox
    sudo apt-get install nasm autoconf2.13 build-essential nodejs python-dev python-pip python-setuptools unzip uuid zip
    sudo apt-get install libpulse-dev libasound2-dev libcurl4-openssl-dev libdbus-1-dev libdbus-glib-1-dev libgtk-3-dev libgtk2.0-dev libpulse-dev libx11-xcb-dev libxt-dev python-dbus xvfb yasm
    ./mach build

    echo Add other tasks to build, test, and deploy your project.
    echo See https://aka.ms/yaml
  displayName: 'Run a multi-line script'
